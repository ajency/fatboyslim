<?phpinclude_once("dbconfig.php");include_once("functions.php");include_once('../OAuth.php');require('../google-api-php-client/src/Google_Client.php');include('../google-api-php-client/src/contrib/Google_CalendarService.php');require("../twolegged.php");function addCalendar($st, $et, $sub, $ade) {    $ret = array();    $ret['IsSuccess'] = true;    $ret['Msg'] = 'add success';    $ret['Data'] = rand();    return $ret;}function addDetailedCalendar($st, $et, $sub, $ade, $dscr, $loc, $color, $tz) {    $ret = array();    $ret['IsSuccess'] = true;    $ret['Msg'] = 'add success';    $ret['Data'] = rand();    return $ret;}function listCalendarByRange($sd, $ed, $cnt,$calendar) {    $cnt=20;    $ret = array();    $ret['events'] = array();    $ret["issort"] = true;    $ret["start"] = php2JsTime($sd);    $ret["end"] = php2JsTime($ed);    $ret['error'] = null;    for($i=0;$i<20;$i++){        $events[]=array(        $calendar['items'][$i]['summary'],        $calendar['items'][$i]['location'],        $calendar['items'][$i]['start']['dateTime'],        $calendar['items'][$i]['end']['dateTime']    );        }            for ($i = 0; $i < $cnt; $i++) {        $rsd = rand($sd, $ed);        $red = rand(3600, 10800);        if (rand(0, 10) > 8) {            $alld = 1;        } else {            $alld = 0;        }        $ret['events'][] = array(            rand(10000, 99999),            $calendar['items'][$i]['summary'],            php2JsTime($rsd),            php2JsTime($red),            rand(0, 1),            $alld, //more than one day event            0, //Recurring event            rand(-1, 13),            1, //editable             $calendar['items'][$i]['location'],            ''//$attends        );    }    return $ret;}function listCalendar($day, $type) {    $sfGoogleCalendar = new sfGoogleApiCalendar('avanti@ajency.in');    $calendar = $sfGoogleCalendar->getEvents('ajency.in_opmps6n2jkeo2keh16v6nj8nkc@group.calendar.google.com');    for ($i = 0; $i < 20; $i++) {                   //$title=$calendar['items'][$i]['summary'];            //$location=$calendar['items'][$i]['location'];            $st=$calendar['items'][$i]['start']['dateTime'];            $et=$calendar['items'][$i]['end']['dateTime'];            }    $phpTime = js2PhpTime($day);    //echo $phpTime . "+" . $type;    switch ($type) {        case "month":            $st = mktime(0, 0, 0, date("m", $phpTime), 1, date("Y", $phpTime));            $et = mktime(0, 0, -1, date("m", $phpTime) + 1, 1, date("Y", $phpTime));                       //$st=$st;            //$et=$et;            $cnt = 50;            break;        case "week":            //suppose first day of a week is monday             $monday = date("d", $phpTime) - date('N', $phpTime) + 1;            //echo date('N', $phpTime);            $st = mktime(0, 0, 0, date("m", $phpTime), $monday, date("Y", $phpTime));            $et = mktime(0, 0, -1, date("m", $phpTime), $monday + 7, date("Y", $phpTime));            $cnt = 20;            break;        case "day":            $st = mktime(0, 0, 0, date("m", $phpTime), date("d", $phpTime), date("Y", $phpTime));            $et = mktime(0, 0, -1, date("m", $phpTime), date("d", $phpTime) + 1, date("Y", $phpTime));            $cnt = 5;            break;    }    //echo $st . "--" . $et;    return listCalendarByRange($st, $et, $cnt,$calendar);}function updateCalendar($id, $st, $et) {    $ret = array();    $ret['IsSuccess'] = true;    $ret['Msg'] = 'Succefully';    return $ret;}function updateDetailedCalendar($id, $st, $et, $sub, $ade, $dscr, $loc, $color, $tz) {    $ret = array();    $ret['IsSuccess'] = true;    $ret['Msg'] = 'Succefully';    return $ret;}function removeCalendar($id) {    $ret = array();    $ret['IsSuccess'] = true;    $ret['Msg'] = 'Succefully';    return $ret;}header('Content-type:text/javascript;charset=UTF-8');$method = $_GET["method"];switch ($method) {    case "add":        $ret = addCalendar($_POST["CalendarStartTime"], $_POST["CalendarEndTime"], $_POST["CalendarTitle"], $_POST["IsAllDayEvent"]);        break;    case "list":        $ret = listCalendar($_POST["showdate"], $_POST['viewtype']);        break;    case "update":        $ret = updateCalendar($_POST["calendarId"], $_POST["CalendarStartTime"], $_POST["CalendarEndTime"]);        break;    case "remove":        $ret = removeCalendar($_POST["calendarId"]);        break;    case "adddetails":        $id = $_GET["id"];        $st = $_POST["stpartdate"] . " " . $_POST["stparttime"];        $et = $_POST["etpartdate"] . " " . $_POST["etparttime"];        if ($id) {            $ret = updateDetailedCalendar($id, $st, $et, $_POST["Subject"], $_POST["IsAllDayEvent"] ? 1 : 0, $_POST["Description"], $_POST["Location"], $_POST["colorvalue"], $_POST["timezone"]);        } else {            $ret = addDetailedCalendar($st, $et, $_POST["Subject"], $_POST["IsAllDayEvent"] ? 1 : 0, $_POST["Description"], $_POST["Location"], $_POST["colorvalue"], $_POST["timezone"]);        }        break;}echo json_encode($ret);?>